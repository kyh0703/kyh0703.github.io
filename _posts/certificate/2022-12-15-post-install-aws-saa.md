---
published: true
title: "AWS SAA-C03 - 정리"
categories:
  - Certificate
tags:
  - [certificate, AWS, SAA-C03]
toc: true
toc_sticky: true
date: "2022-12-15 12:00"
---

### AWS(Amazon Web services)

* 온디맨드 방식으로 쉽게 확장할 수 있는 서버, 서비스 제공

#### Regions

* 데이터 센터의 집합

**리전 선택 영향 요인**

* 법률 준수
    * 프랑스 데이터는 프랑스에서만 있어야 됌
* 지연시간
    * 지역이 가까울 수록 지연시간이 줄어듬
* 모든 리전이 모든 서비스를 가지고 있지 않음
* 요금

#### AWS Avaliablity zones

* 가용영역은 리전 안에서만 존재
* 리전은 많은 가용 영역을 가질 수 있음
* 보통 3, 최소 2, 최대 6개까지
* 재난에 대비해 서로 단절되어 있음

### IAM(Identity and Access Management)

* 사용자를 생성
* 그룹에 배치
* 사용자들을 그룹으로 묶어서 관리할 수 있다.
* 한 사용자가 다른 여러 그룹에 속할 수 있다.

#### 패스워드정책

* 패스워드 변경 정책
* MFA
    * 사용자의 디바이스와 같이 인증

### EC2(Elastic Compute Cloud)

* 온디맨드 인스턴스
    * 사용한 만큼 금액 지불
* 정기 예약 인스턴스
    * 1년이나 3년주기로 계약
    * 선불 혹은 달마다
* 전환형 예약 인스턴스
    * 예약 후 인스턴스 유형을 변경 할 수 있다.
* 스팟 인스턴스
    * 설정한 가격에 맞을 경우 인스턴스를 실행
    * 인스턴스가 파괴될 수 있음
    * 온디맨드와 비교해서 최대 90% 할인가능

#### spot instance and spot fleet

**스팟블록**

* 특정기간 동안 인스턴스를 차단하는 기능
* 2022년 12월 31일자로 서비스 종료

**스팟요청**

* 일회성 요청
    * 일회성 요청으로 스팟 요청이 완료된 후 요청은 사라진다.
* 지속적인 요청
    * 지속적으로 스팟을 요청하게 되며, 생성 후에도 스팟 요청이 남아있다.

> 스팟을 지우기 위해서는 스팟 요청을 삭제 후 인스턴스를 종료시켜야된다.

#### 스팟집합(spot fleet)

한 세트의 스팟 인스턴스에다가 선택적으로 온디맨드 인스턴스를 조합해 사용하는 방식

정해진 예산이나 정해진 용량이 도달하면 인스턴스 실행을 멈춤

**할당 전략**

lowestPrice
* 가장 적은 비용을 가진 풀에서부터 인스턴스를 실행
* 아주 짧은 워크로드에 적합

diversified
* 모든 풀에 거쳐 분산이 됨
* 한 풀이 종료되더라도 다른 풀에서 가동 됨

capacity optimized
* 인스턴스의 개수에 따라서 최적용량으로 실행이 되고 적절한 풀을 찾아주는 옵션

### IP

**public**

공용 아이피

**private**

사설 아이피

#### Elastic IPs

* 인스턴스가 재시작되어도 유지되는 public IP

* 계정당 5개

> 탄력적 아이피보단 임의의 공용 IP를 써서 DNS이름을 할당하는 것이 좋음. 또는 로드밸런서를 사용

#### Placement Groups(배치그룹)

EC2 인스턴스가 AWS인프라에 배치되는 방식을 제어하고자 할 때 사용

**3가지 생성 전략**

cluster

* 단일 가용 영역 내에서 지연시간이 짧은 하드웨어 설정
* 동일한 랙에 구성 됨(동일한 가용영역)
* 10Gbps
* 하드웨어가 고장나면 ec2인스턴스가 다 종료 됨
* 극히 짧은 지연시간, 고속의 네트워크

spread

* 인스턴스가 다른 하드웨어(랙, 가용영역)에 분산
* 배치그룹 당 7개의 EC2인스턴스만 가짐
* 동시 실패의 위험 감소

partition

* 여러 파티션에 인스턴스를 분할
* 파티션은 다운 오류 파티션과 격리됨
* 가용영역당 7개 파티션
* 각 파티션은 랙을 말함
* 랙 실패로부터 안전함
* HDFS, HBase, Kafka, Cassndra

#### ENI(Elastic Network Interfaces)

* VPC의 논리적 구성요서이며 가상 네트워크 카드를 나타냄(NIC)

* 인스턴스가 네트워크에 엑세스 할 수 있게 해줌

**속성**

* 주요 사설 IPv4와 하나 이상의 보조 IPv4를 가질 수 있음

* ENI에 하나이상의 보안 그룹을 연결 할 수 있음
* 인스턴스와 독립적으로 ENI를 생성하여 즉시 연결하거나 장애 조치를 위해 EC2인스턴스에서 이동시킬 수 있음

#### EC2 Hibernate(절전모드)

* 절전모드가 되면 램에 있던 인 메모리 상태는 보존 됨
* EBS 볼륨에 기록되어 있음
* 빠르게 재 부팅하거나 RAM상태를 저장하고 싶을 때
* 베어메탈 인스턴스 적용 X
* 루트 볼륨, 즉 EBS에만 저장이 가능
* 암호화가 필요
* 절전 모드는 최대 60일이 최대 기간

**순서**

1. 인스턴스를 절전모드로 설정
2. 인스턴스의 메모리는 EBS에 기록
3. 인스턴스 중지 시 RAM은 제거
4. EBS의 기록된 RAM  dump를 가지고 부팅

### EC2  인스턴스 스토리지

#### EBS(Elastic Block Store)

* 네트워크 드라이버
* USB와 같다 생각하면 됨
* 인스턴스가 종료된 후에도 데이터를 지속 가능
    * CCP: 하나의 인스턴스에 하나의 EBS
    * 어소시에이트 레벨: 일부 EBS 다중연결
* 특정 가용영역에서만 생성 가능
    * 스냅샷을 이용하면 다른 가용영역으로 볼륨을 이동시킬 수 있음

> 종료시 삭제 기능을 Enable/Disable로 EC2인스턴스가 종료시 root볼륨을 유지할 수 있다.

#### EBS Snapshot

* EBS볼륨의 특정시점에 대한 백업

* 다른 가용영역이나 다른 리전에도 복사할 수 있음

**EBS Snapshot Archive**

* 최대 75%까지 저렴한 아카이브 티어로 스냅샷을 옮길 수 있는 기능
* 아카이브를 복원하는데 24시간에서 최대 72시간까지 걸림
* 즉시 복원 X 

**Recycle Bin for EBS Snapshot **

* EBS 스냅샷을 영구 삭제 하는 대신 휴지통에 넣음
* 기간을 1일에서 1년까지 지정 가능

**Fast Snapshot Restore(FSR)**

* 스냅샷을 완전 초기화해 지연시간을 없애는 기능
* 인스턴스를 빠르게 초기화할때 유용
* 비용이 많이 듬

### AMI(Amazon Machin Image)

* 사용자 지정 인스턴스를 나타냄

**AMI 종류**

* Public AMI

* Your Own AMI

* An AWS Marketplace
* Community

### ECS Instance Store

EC2 인스턴스는 가상 머신이지만 실제로 하드웨어 서버에 연결되어 있다.

물리적으로 연결된 디스크 공간을 `EC2인스턴스 스토어`라고 부른다

* 향상된 디스크 성능
* ec2인스턴스를 종료하면 손실된다.
* 임시 스토리지
* 버퍼, 캐시를 저장하는 임시콘텐츠를 사용하는 경우
* 장기 스토리지는 EBS가 적합

### EBS 볼륨 유형

#### 범용 SSD(gp2/gp3)

* 다양한 워크로드에 대해 가격과 성능의 절충안이 되어줌
* 부팅볼륨으로 사용될 수 있음
* 1GB ~ 16GB 까지 다양함
* 개발, 테스트, 가상데스크톱
* gp2는 예전 버전으로 최대 3000IOPS에 볼륨과  최대용량이 
* gp3는 최신 세대 볼륨으로 3000 IOPS와 초당 125MB의 처리량을 제공

#### 프로비저닝 된 IOPS (io1/io2)

* 최고 성능을 자랑함
* 부팅 볼륨으로 사용할 수 있음

* 16000 IOPS성능을 유지할 필요가 있는 애플리케이션
* 데이터베이스 워크로드
  * io1/io2(4GiB - 16Tib)
    * Max PIOPS: 64000 for Nitro EC2
    * `Nitro EC2` 인스턴스가 아닐경우 32000IOPS
    * io2는 4GB ~ 64TB

#### st1(HDD)

저비용의 HDD볼륨으로 잦은 접근과 처리량이 많은 워크로드에 사용

최대 16TB 까지 확장되며 두가지 볼륨을 제공한다.

#### 콜드 HDD sc1(HDD)

가장 비용이 적게 드는 HDD볼륨으로 접근 빈도가 낮은 워크로드에 사용

### EBS 다중 연결(io1/io2)

다중 연결 기능은 하나의 EBS 볼륨을 같은 가용영역에 있는 여러 EC2인스턴스에 연결 할 수 있게 해줌

* io1, io2만 가능
* 같은 가용영역내에서만 사용 할 수 있다.
* 16개의 EC2인스턴스 만 같은 볼륨에 연결 할 수 있다

### EBS 암호화

* 볼룸간 데이터, 및 저장되는 볼륨역시 암호화 된다.

### EFS(Elastic File System)

* 관리형 NFS(Network File System)
* 여러 EC2인스턴스에 마운트 될 수 있음
* EC2인스턴스는 여러 가용 영역에 있을 수 있다.
* 가용성이 높고 확장성도 높다
* 그만큼 가격이 비쌈
* WIndow가 아닌 Linux AMI와 호환 됨
* 파일 시스템이 자동으로 확장되고 사용량에 따라 요금을 지불
* 따라서 용량 계획하지 않아도 됨
* 웹서버, 데이터 공유 word Press에 사용
* 처리량은 초당 10GB

#### 성능모드

**범용모드**

기본 설정으로 민감한 웹 서버

* 최대 IO
  * 처리량을 높이고 싶다면 사용
* 미디어 처리 작업이 있을 때 유용

**처리량 모드**

`버스팅모드`가 기본값

* 초당 50MiB ~ 초당 100Mib까지 버스트 할 수 있음
* 프로비저닝 모드에서는 크기에 상관없이 처리량을 설정 할 수 있다.

## 로드밸런서

#### CLB(Classic Loadbalancer)

* 만료됐음

#### ALB(Application Loadbalancer)

* L7
* path, query, header.. 등으로 라우팅 할 수 있음

#### NLB(Network Loadbalancer)

* TCP, TLS, UDP
* 고성능의 L4 지원 로드 밸런서

#### GWLB(Gateway Load Balancer)

* 인그레스 게이트웨이처럼 들어오는 트래픽을 가지고 검증을 한 후 애플리케이션에 분배
* `GENEVE` 6081 포트를 사용

#### Sticky Sessions(Session Affinity)

* 쿠키에 데이터를 심어 처음 연결된 인스턴스와 연결 시켜줌
    * Application Based Coookies
    * Duration-based Cookie
        * Cookie Name: `AWSALB`

#### Cross Zone Load Balancing

크로스 로드밸런서를 사용하면 다른 가용영역안에 인스턴스들에게 동일한 트래픽을 분배함

**ALB**

* 항상 켜져 있음
* 끌 수 없다

**NLB**

* 기본 값 꺼져있음
* 키면 돈을 지불함

**CLB**

* 기본 값 꺼져있음
* 켜도 돈을 지불하지 않음

#### Elastic Load Balance(ELB) - SSL 인증서

* `ACM(AWS Certificate Manager)`를 통해 SSL인증서를 관리할 수 있음

**SNI**(sever Name Indication)

* 최신 프로토콜
* 대상 서버의 호스트이름을 지정하여야 됨
* ALB, NLB 같은 최신 로드밸런서에서 사용가능
* 서로 다른 인증서를 사용하여 다른 웹사이트로 연결되는 다수의 대상그룹을 가질 수 있음
    * CLB는 하나의 인증서만
    * NLB, ALB는 다수의 리스너를 지원

#### Elastring Load Balancer-Connection Draining

* 연결드레이닝 = 등록 취소 지연
* 인스턴스가 등록 취소, 혹은 비정상적인 상태에 있을 때 어느정도 시간을 주어 활성 요청을 완료할 수 있는 기능

#### Auto Scaling Group(ASG)

* 스케일 인 / 스케일 아웃 할 때 사용
* 최소 및 최대 갯수, 목표 개수 설정 가능
* 로드 밸런서에 묶어서 사용할 수 있음
* 비용은 무료
* `ASG Launch Template`으로 생성
* `Cloud Watch`에 경보를 통해 ASG를 컨트롤(ex 평균 CPU 사용량)

#### Auto Scaling Groups - Dynamic  Scaling Polices

* Target Tracking Scaling
    * 대상 추적 스케일링
    * 가장 단순하고 설정하기 쉬움
    * 평균 CPU 사용량처럼 기준 선을 세워두고 사용
* Smple/step scaling
    * Cloud Watch 경보를 설정하고 인스턴스를 추가
    * 기준선 아래면 인스턴스를 삭제하는 옵션도 추가할 수 있음
* Sheduled Action
    * 사용패턴을 바탕으로 스케일링을 예상
    * 5시에 행사가 있을 때 해당 시간에 인스턴스 수를 늘림
* Predictive Scaling
    * 시간에 걸쳐 과거 로드를 분석하여 인스턴스 수를 조정
    * 머신러닝 기반

**정책**

* CPUUtilzation: CPU 평균
* RequestCountPerTarget: EC2 인스턴스에 request 사용량
* Average Network In / out: 네트워크 병목 현상 기준으로
* Any: `CloudWatch`에서 커스텀하여 직접 설정할 수 있음

**Scaling Cooldowns**

스케일링이 작업이 끝날 떄마다 인스턴스의 추가 또는 삭제를 막론하고 5분 혹은 300초의 휴식 기간을 갖는것

휴식기간에는 추가인스턴스를 실행 또는 종료 할 수 없다.

## RDS

**종류**

* Postgres
* Mysql
* maria
* oracle
* microsoft sql server
* aurora

#### Auto Scaling

* 오토 스케일링이 활성화 되어 있으면 자동으로 스토리지를 확장해줌

* IOPS 임계값 확인
* 확장 할 최대치 정하기
* 모든 RDS 데이터베이스 엔진에서 지원
* Maria, mySql postgres, SQL, oracle

#### 읽기전용 복제본과 다중 AZ

**읽기전용복제본**

* 읽기 인스턴스를 스케일링 함
* 최대 다섯개까지 생성할 수 있음
* 동일한 AZ 또는 리전을 걸쳐서 생성될 수 있음
* 비동기식 복제
* Only For `SELECT`
* 동일한 리전이면 비용이 부과 되지 않으나, 다른 리전이면 비용이 부과 됨

**다중 AZ**

* 재해 복구에 사용
* 마스터 - 슬레이브
* 가용성
* 재해 복구를 위해 읽기전용 복제본을 다중 AZ로 설정 가능
* 동기식 복제

**시험에 나오는 문제**

* 단일 AZ에서 다중 AZ로 전환 시 데이터베이스를 중지 할 필요가 없음
* AZ기능을 활성화 시키면 됨
* 스냅 샷으로 동기화

#### RDS Custom

* 기 데이터베이스와 OS에 엑세스 할 수 있음
* 오라클 및 MS SQL Server만 관리할 수 있음

#### Amazon Aurora

* aws의 고유 기술
* Postgres, Mysql 과 호환
* 클라우드에 최적화
* Mysql 5배, postgres 3배 높은 성능
* 스토리지 자동 확장 10GB -> 128TB
* 일기 전용 복제본 15개까지 가능
* 전체 적으로 다 빠름
* 비용은 20% 정도 높음
* 높은 가용성과 읽기 스케일링
* 6개의 사본을 저장함 (이중 4개만 있어도 괜찮음)
* 수백개의 볼륨 사용
* 매우 빠른 장애 조치
* 쓰기 엔드포인터(마스터 인스턴스와 연결됨)
* 리더 엔드포인터(읽기전용복제본과 연결됨) - 로드벨런싱
* 백트랙 (과거시점으로 데이터 복원)

#### Aurora 고급개념

**복제본 자동 스케일링**

* 읽기요청이 매우 많을 경우 오토스켈링을 설정하면 확장 됨
* 리드 엔드포인터도 같이 확장됨

**사용자지정 엔드포인트**

* 사용자지정엔드포인터를 통해서 특정 인스턴스로 요청 가능
* 특정 서브넷으로만 가도록 지정할 수 있음

**서버리스기능**

* 실제 사용량에 기반한 자동 데이터베이스 인스터화
* 자동 스케일링
* 인스턴스당 매 초당 비용을 지불
* 비용 면에서 효율적

**멀티마스터**

* 높은 가용성을 주기 위해서 멀티마스터 기능을 사용할 수 있음
* 모든 노드에서 읽기 및 쓰기가 가능함
* 즉각적인 장애 조치가 가능함(리더선출 지연시간이 없음)

**Global Aurora**

* 리전 간 복제
* 재해 복구
* 최근에 Global 데이터베이스로 만드는 것을 권장
* 리전 최대 5개까지 지정가능
* 읽기전용 복제본 16개까지 사용가능
* RTO(Recovery Time Objective/복구목표시간) 1분 미만

**머신러닝**

* SagaMaker: 어떤 머신 러닝 모델이라도 사용할 수 있게 해줌
* Amazon Comprehend: 감정분석

#### 백업과 모니터링

**자동백업**

* 매일 정해진 시간에 데이터베이스를 전체를 백업
* 5분마다 트랜잭션 로그도 백업
* 5분전 어떤 시점으로 복구가 가능
* 자동 백업 보유기간은 1 - 35일
* 기간이 지나면 사라짐

**수동 DB 스냅샷**

* 사용자가 수동으로 트리거
* 원하는만큼 오랫동안 보유할수 있다.

> 비용 측면에서는 2시간 사용 후 스냅샷을 만들고 데이터베이스를 삭제하면 더 저렴하게 사용할수 있다

**aurora 백업**

* 1 - 35일
* 비활성화는 불가능함
* 지정시간 복구기능
* 원하는 기간 보유가 가능

**RDS & AUrora Retore Option**

* 스냅샷
* S3
* Aurora Cluster from S3
    * 온프레미스 데이터베이스를 Percona XtraBackup을 사용하여 s3로 백업

**Aurora Database Cloning**

* 기존 데이터베이스로 부터 새로운 Aurora DB 클러스터를 만들 수 있음.

#### RDS Security

* 데이터 암호화
* KMS를 사용해 모든 데이터를 암호화함
* 마스터를 암호화하지않았으면 읽기전용도 암호화 되지 않음
* 사용자 이름이나 패스워드나 IAM Role
* 보안 그룹을 통해 특정 접근을 차단 할 수 있음

#### RDS proxy

* 프록시를 사용하면 데이터베이스 연결 풀을 형성하고 공유할 수 있음
* 완전한 서버리스
* 오토 스케일링이 가능함
* 다중 AZ지원
* 장애조치시간을 66%까지 줄일 수 있음
* Mysql, PostgresQL, Maria and Aurora
* Lamda

#### Elastic Cache

* Redis, MemCache등 캐시 기술을 관리
* 인메모리 데이터베이스

**redis vs Memcache**

* redis(고가용성)

    * redis 는 다중 AZ 가능

    * 읽기전용 인스턴스 확장이 가능

    * 가용성이 높음

    * 백업 복원 기능

* Memcache(단순 분산 캐시)
    * 샤딩
    * 데이터 분할 다중 노드
    * 가용성이 높지 않음
    * 복제도 없고, 백업, 복원 기능도 없음
    * 멀티쓰레드

#### Elastiac Cache Security

Redis Auth

* IAM 지원하지 않음
* API 레벨에서만 IAM을 지원
* 클러스터 생성시 비밀번호/토큰을 설정가능
* SSL 보안을 지원할 수 있음

Memcached

* SASL based authentication

**정책**

Lazy Loading: 모든 읽기 데이터를 캐시(캐시 히트가 없을때 디비에서 가져옴)

Write Through:  디비에 쓸 때 캐시를 업데이트함

Session Store: 세션 데이터를 임시로 저장(TTL사용)

## Route 5

